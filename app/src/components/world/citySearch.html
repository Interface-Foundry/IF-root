<div class="aperture-pop u-pointer" ng-click="apertureSet('full')" ng-show="aperture.state=='aperture-third'"></div>
<div id="shelf" class="search--retail" ng-class="[aperture.state]">
	<div id='top-shelf' class="noPreventDefault"
		ng-class="[aperture.navfix, aperture.state]" 
		ng-style="::{'background-color': style.navBG_color}" 
		ng-click="apertureToggle('full')"
		ng-swipe-up="apertureSet('off')"
		ng-swipe-down="apertureSet('full')"
		world-shelf>
		<div class="world-title noPreventDefault" fit-font>
			<span class="vertical-middle noPreventDefault">{{cityName}}</span>
		</div>
	</div>

	<div class="shelf-surface wrap" bubble-body>		
		<div class="surface" ng-style="::{'background-color': style.bodyBG_color}">

			<cat-search-bar ng-if="searchBarText && aperture.state !== 'aperture-full'" 
				color="style.navBG_color"
				text="searchBarText"
				populate-city-search-view="populateCitySearchView"
				loading="loading"
				mode="'city'"></cat-search-bar>

			<!-- category widget -->
			<div class="marble-page" 
				ng-if="style.widgets.category && show.generic">
				<header class="marble-page-header" ng-style="::{color: style.categoryTitle_color}">
					<div class="marble-page-header-icon"><img src="img/icons/widgets_16.png" width="16px" height="16px" style="display: block;"></div>
				Categories
				</header>
				<category-widget ng-if="::style.widgets.category"
					aperture="off"
					categories="world.landmarkCategories"
					style="style"
					populate-search-view="populateSearchView"
					world="world"></category-widget>
			</div>

			<!-- grouped landmarks (landmark or bubble) -->
			<!-- <div class="bubble-group" 
				ng-repeat="group in groups"
				ng-if="show.category || show.text"> -->
				<!-- <header class="bubble-group-label">{{::group.letter}}</header> -->
				<ul class="bubble-list" ng-if="cityShow.text || cityShow.category">
					<li class="bubble-list-item" 
						ng-repeat="landmark in citySearchResults track by $index"
						ng-click="go('w/' + world.id + '/' + landmark.id)">
							<img if-src="{{ landmark.avatar }}" class="bubble-list-item-img">
							<span>{{ landmark.name }}</span>
					</li>
				</ul>
			<!-- </div> -->
			
		</div>
	</div>
</div>

<category-widget ng-if="::style.widgets.category"
	ng-show="aperture.state === 'aperture-full'"
	class="category-map-view-scroll"
	aperture="full"
	categories="world.landmarkCategories"
	style="style"
	populate-search-view="populateSearchView"
	world="world"></category-widget>

<user-location class="if-animate"
	style="style" 
	ng-class="[aperture.state]">
</user-location>

<cat-search-bar class="search-aperture" 
	ng-if="searchBarText && aperture.state === 'aperture-full'" 
	color="style.navBG_color"
	text="searchBarText"
	populate-city-search-view="populateCitySearchView"
	loading="loading"
	mode="'city'"></cat-search-bar>
