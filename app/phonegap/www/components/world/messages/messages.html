
<!-- spooky -->
<div ng-show="showSpookytest" class="spooky-top-pattern"></div>

<span ng-show="showSpookytestloggedin">
	<div class="spooky-nickname-info visible-xs hidden-sm hidden-md hidden-lg">
		<h4 style="font-size:13px;" class="inner-nickname"><!-- Chatting as --></h4>
		<p style="margin-top:-31px; margin-left:-13px; margin-bottom:0px; color:#001562;"><small><b>Chatting as </b></small> <img style="border-radius:50%;" width="40" height="40" if-src="{{::user.avatar}}">{{nick}}</p>
		<a if-href="#profile/worlds/messages">
			<button style="margin-top:-33px; margin-right:7px; background-color:#8f8bc3; color:#000;" type="button" class="lightblue500 btn btn-default btn-xs edit-nickname"><span class="glyphicon glyphicon-pencil"></span> Edit</button>
		</a>
	</div>
</span>
<!-- end spooky -->



<nav class="subnav navfix" ng-class="{'spooky-subnav': showSpookytest}">
	
	<a if-href="#w/{{world.id}}" class="subnav-back">
		<span class="glyphicon glyphicon-chevron-left subnav-back-chevron"></span>
	</a>

	<!-- BEGIN SPOOKY CHAT TEST -->

	<!-- show on test -->
	<div ng-show="showSpookytest">
		<h4 class="subnav-header subnav-chat-head" style="color:#8f8bc3;">Union `Scare` Park<p class="subnav-chat-subhead" style="color:#ffa700;">{{world.name}}</p></h4>
	</div>

	<!-- hide from test -->
	<div ng-hide="showSpookytest">
		<h4 class="subnav-header subnav-chat-head">Messages<p class="subnav-chat-subhead">{{world.name}}</p></h4>
	</div>

	<!-- END SPOOKY CHAT TEST -->


	<!-- hidden on spooky test -->
	<a href="/profile/worlds/messages" class="visible-xs hidden-sm hidden-md hidden-lg">
		<span class="glyphicon glyphicon-pencil subnav-chat-edit" ng-hide="showSpookytest" ></span>
	</a>

	<!-- shown on spooky test -->
	<span onclick="alert('This is a chat room just for Union Square Park during Halloween, made by Bubbl.li');" ng-show="showSpookytest" class="glyphicon glyphicon-question-sign subnav-chat-edit"></span>

</nav>


<div class="message-surface">
	<div class="message-room-col hidden-xs">
		<div class="nickname-info">
			<h4 class="inner-nickname">You're chatting as</h4>
			<p><img style="border-radius:50%;" width="50" height="50" if-src="{{::user.avatar || 'img/icons/profile.png'}}" src="/img/icons/profile.png">  {{nick}}</p>
			<a if-href="#profile/me/messages">
				<button type="button" class="lightblue500 btn btn-default btn-xs edit-nickname"><span class="glyphicon glyphicon-pencil"></span> Edit</button>
			</a>

		</div>
	</div>
	<ul class="message-list">
		<li class="if-animate message" ng-repeat="msg in messages track by msg._id" ng-class="{ 'message-hidden' : msg.hidden }">
			<picture class="msg-avatar" ng-if="msg.userID!=userID">
				<img width="32px" height="32px" class="small-avatar" if-src="{{::msg.avatar || 'img/icons/profile.png'}}" ng-cloak>
			</picture>

			<div class="message-content user-message-content" ng-if="msg.userID==userID" ng-style="{'background-color': style.titleBG_color}">
				<div class="message-corner" ng-style="{'border-bottom': '6px solid '+style.titleBG_color}" ng-click="changeName"></div>
				<h6 class="message-heading message-self" ng-bind="msg.nick">Visitor</h6>
				<img class="img-responsive" if-src="{{::msg.pic}}" ng-if="msg.pic" >
				<p class="message-body" ng-bind="msg.msg" ng-if="msg.msg" ></p>
			</div>
			<div class="message-content" ng-if="msg.userID!=userID" ng-class="{'spooky-chatbox': showSpookytest}">
				<h6 class="message-heading" ng-bind="msg.nick">Visitor</h6>
				<img class="img-responsive" if-src="{{msg.pic}}" ng-if="msg.pic">
				<p class="message-body" ng-bind="msg.msg" ng-if="msg.msg" ng-class="{'spooky-text': showSpookytest}"></p>
			</div>
		</li>
	</ul>

	<div class="view-footer" ng-class="{'message-logged-out-footer': !loggedIn}" ng-cloak>

		<!-- hide from test -->
		<div ng-show="loggedIn">
			<textarea rows="1" placeholder="Type your message" class="message-input" ng-model="msg.text" ng-keydown="$event.keyCode==13&&!$event.altKey ? sendMsg($event) : 0" msd-elastic autofocus></textarea>
			<button type="button" class="message-send" ng-class="{'lightblue500': loggedIn}" ng-click="sendMsg()">Send</button>
			<div class="message-photo" ng-file-select="onImageSelect($files)" data-accept="image/*"></div>
		</div>

		<!-- show on test -->
		<div ng-hide="loggedIn">
			<textarea rows="1" placeholder="Login to write message" class="message-input" ng-model="msg.text"></textarea>
			<button type="button" class="message-send" ng-class="{'lightblue500': loggedIn}" onclick="alert('Login to send a message');">Send</button>
			<div class="message-photo"></div>
		</div>

		
	</div>

</div>



<div class="login-chat" ng-hide="loggedIn" ng-cloak>
      <div class="input-group">
          <h4>Social login to send messages</h4>
          <!-- @IFDEF WEB -->
          <a if-href="#auth/facebook?redirect=%2Fw%2F{{world.id}}%2Fmessages" class="btn btn-primary"><span class="fa fa-facebook"></span> Facebook</a>
          <a if-href="#auth/twitter?redirect=%2Fw%2F{{world.id}}%2Fmessages" class="btn btn-info"><span class="fa fa-twitter"></span> Twitter</a>
          <a if-href="#auth/meetup?redirect=%2Fw%2F{{world.id}}%2Fmessages" ng-hide="showSpookytest" class="btn btn-meetup"><span class="fa fa-twitter"></span> Meetup</a>
          Or:<!-- @ENDIF --> <a ng-href="/signup/messages" class="btn btn-default"><span class="fa fa-twitter"></span> Signup</a>
      </div>
</div>
